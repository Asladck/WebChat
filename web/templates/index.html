<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Main</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<h1>Welcome, <span id="username">Guest</span>!</h1>
<button onclick="window.location.href='/chat'">Go to Chat</button>

<script>
    const token = localStorage.getItem("access_token");
    if (!token) {
        window.location.href = "/sign-in";
    } else {
        try {
            const payload = JSON.parse(atob(token.split('.')[1]));
            const username = payload.username;
            if (username) {
                document.getElementById("username").textContent = username;
            } else {
                throw new Error("No username in token");
            }
        } catch (e) {
            console.error("Token error:", e);
            localStorage.removeItem("access_token");
            localStorage.removeItem("refresh_token");
            localStorage.removeItem("username");
            window.location.href = "/sign-in";
        }
    }
</script>
</body>
</html>
